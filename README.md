# Курсовая работа по предмету "Проектирование высоконагруженных систем"

## Содержание
- [1. Тема и целевая аудитория](#1-тема-и-целевая-аудитория)
  - [Тема](#тема)
  - [Целевая аудитория](#целевая-аудитория)
  - [Топ 5 по числу пользователей стран](#топ-5-по-числу-пользователей-стран)
  - [Функционал](#функционал)
- [2. Расчет нагрузки](#2-расчет-нагрузки)
  - [Продуктовые метрики](#продуктовые-метрики)
    - [Аудитория](#аудитория)
    - [Средний размер хранилища](#средний-размер-хранилища)
    - [Среднее количество действий пользователя](#среднее-количество-действий-пользователя)
  - [Технические метрики](#технические-метрики)
    - [Размер хранения](#размер-хранения)
    - [Сетевой трафик](#сетевой-трафик)
- [Список использованных источников](#список-использованных-источников)

## 1. Тема и целевая аудитория

### Тема
  **Steam** — онлайн-сервис цифрового распространения компьютерных игр и программ.

### Целевая аудитория
  - 69 миллионов ежедневных активных пользователей (DAU). [^2]
  - 132 миллиона ежемесячных активных пользователей (MAU). [^1]
  - Пик одновременных пользователей онлайн - 39.31 млн [^2]

### Топ 5 по числу пользователей стран:
  Информация взята с источника [^3]
  | Страна   | Число пользователей |
  |----------|---------------------|
  | США      | 39.31 млн           |
  | Китай    | 11.4 млн            |
  | Россия   | 9.5 млн             |
  | Бразилия | 4.9 млн             |
  | Германия | 3.6 млн             |

### Функционал
 Основной фукционал сервиса заключается в приобретении игр и обмене/продаже внутриигровых предметов

 Функционал MVP:
 - Регистрация и аутентификация
 - Список игр (магазин)
 - Корзина с добавленными играми
 - Торговая площадка
 - Библиотека игр пользователя
 - Система торгового предложения по обмену внутриигровыми предметами (trade offer)
 - Профиль пользователя

## 2. Расчет нагрузки
### Продуктовые метрики:
#### Аудитория
- 69 миллионов ежедневных активных пользователей (DAU). [^2]
- 132 миллиона ежемесячных активных пользователей (MAU). [^1]
#### Средний размер хранилища
Профиль
| Данные             | Средний размер                          |
|--------------------|-----------------------------------------|
| Аватарка           | 11 KB                                   | 
| Информация профиля | 28 байт                                 |
| Статистика игр     | 231 байт (21 байт на 1 игру)            |
| Сумма              | 11.259 KB                               |

- Информация профиля: имя (10 символов, 20 байт) + краткое описание (4 символа, 8 байт)
- Статистика игры: идентификатор игры (4 байта) + кол-во часов (4 байта) + последний запуск (13 байт)
- Согласно [^7] в среднем у пользователя 11 игр. Отсюда получаем 21 * 11 = 231 байт

Игра
| Данные                  | Средний размер                |
|-------------------------|-------------------------------|
| Шапка                   | 44 KB                         |
| Скриншот                | 3.1 MB (389 KB на 1 скриншот) |
| Информация              | 4 KB                          |
| Файлы игры              | 20 GB                         |
| Сумма                   | 20.003148 GB                  |

- Было проанализировано 1000 случайных игр из магазина Steam
- В среднем у игры 8 скриншотов. Отсюда получаем 8 * 389 KB = 3.1 MB

Игровой предмет
| Данные             | Средний размер      |
|--------------------|---------------------|
| Картинка           |                     |
| Описание           |                     |

#### Среднее количество действий пользователя
| Действие                        | Среднее число в день |
|---------------------------------|----------------------|
| Регистрация/Аутентификация      | 0.03                 |
| Просмотр игры                   | 1.72                 |
| Покупка игры                    | 0.005                |
| Совершение торгового обмена     | 0.029                |
| Выставление предмета на продажу | 0.007                |
| Просмотр профиля                | 0.295                |
| Обновление профиля              | 0.03                 |
| Просмотр предметов              | 0.18                 |

- Пользователь авторизуется в Steam в среднем раз в месяц. Тогда в день: 1 / 30 = 0.03
- Продано игр за год: 132М [^5] => За день: 132M / 365 = 361643 => один пользователь в среднем за день покупает: 361643 / 69M = 0.005
- Расчитаем число просмотров игры:
  - Согласно [^9] средняя конверсия: от 2 до 4%. Возьмем среднее: 3%. То есть для одной покупки необходимо: 1 / 0.03 = 33 посещения.
  - Предположим, что пользователь просматривает в среднем 10 страниц с играми. Тогда: 33 * 10 = 330 посещений.
  - Тогда общее число просмотров в день: 361643 * 330 = 119М
  - Тогда на одного пользователя: 119M / 69M = 1.72
- Созданных торговых предложений за месяц: 58M [^4] => За день 58M / 30 = 2M => один пользователь в среднем создает торговых обменов: 2M / 69M = 0.029
- За период 1 июля - 1 сентября 2025г [^8] в среднем в месяц выставлялось 1.5М предметов => за день: 1.5M / 30 = 500000 => один пользователь в среднем выставляет на продажу: 0.007
- Чтобы обновить профиль, его надо открыть. Также следует учитывать что перед совершением обмена также будет смотреться профиль пользователя. Предположим, что каждое такое действие порождает в среднем 5 просмотров профилей. Тогда получим: (0.03 + 0.029) * 5 = 0.295
- Пользователь обновляет данные профиля в среднем раз в месяц. Тогда в день: 1 / 30 = 0.03
- Чтобы выставить предмет на продажу или совершить обмен, необходимо посмотреть инвентарь с предметами. Предположим что каждое такое действие порождает в среднем 5 просмотров инвентаря. Тогда получим: (0.029 + 0.007) * 5 = 0.18

### Технические метрики
#### Размер хранения
| Тип данных      | Размер для одного | Количество | Размер для всех |
|-----------------|-------------------|------------|-----------------|
| Пользователь    | 11.259 KB         | 982М       | 11 TB           |
| Игра            | 20.003148 GB      | 114662     | 2.3 PB          |
| Игровой предмет |                   |            |                 |

- Согласно [^10] на момент 2020 года в Steam было зарегистрировано 667М аккаунтов. Согласно [^7] в 2017 году прирост пользователей был 63М. Тогда к 2025 получим: 667М + 63М * 5 = 982М.
  - Тогда: 11.259 KB * 982M = 11 TB
- Согласно [^6] в Steam на данный момент 114662 игр. Тогда: 20.003148 GB * 114662 = 2.3 PB

#### Сетевой трафик
RPS
Для расчета воспользуемся таблицей с действиями пользователя и формула: (количество запросов в день от одного пользователя * DAU) / 86400
Пиковый RPS возьмем в 2 раза выше среднего.
| Действие                        | RPS              | RPS в пике        |
|---------------------------------|------------------|-------------------|
| Регистрация/Аутентификация      | 24               | 48                |
| Просмотр игры                   | 1374             | 2748              |
| Покупка игры                    | 4                | 8                 |
| Совершение торгового обмена     | 23.16            | 46.32             |
| Выставление предмета на продажу | 5.6              | 11.2              |
| Просмотр профиля                | 235.6            | 471.2             |
| Обновление профиля              | 24               | 48                |
| Просмотр предметов              | 144              | 288               |

Общая нагрузка
Формула для средней нагрузки: трафик * RPS
Формула суммарной суточной нагрузки: Средняя нагрузка * 86400 секунд * 0.125
Пиковую нагрузку возьмем в 2 раза выше средней

| Действие                        | Трафик на действие | Средняя нагрузка (Гбит/с) | Пиковая нагрузка (Гбит/с) | Суммарная суточная нагрузка (Гбайт/с) |
|---------------------------------|--------------------|---------------------------|---------------------------|---------------------------------------|
| Аутентификация                  | 888 байт           | 0.00017                   | 0.00034                   | 1.836                                 |
| Просмотр игры                   | 2.66 KB            | 0.03                      | 0.06                      | 324                                   |
| Покупка игры                    | 286 байт           | 0.000009                  | 0.000018                  | 0.0972                                |
| Совершение торгового обмена     | 2.61 KB            | 0.0005                    | 0.001                     | 5.4                                   |
| Выставление предмета на продажу | 2.15 KB            | 0.0000986                 | 0.0001972                 | 1.06488                               |
| Просмотр профиля                | 2.11 KB            | 0.004                     | 0.008                     | 43.2                                  |
| Обновление профиля              | 4.36 KB            | 0.00086                   | 0.00172                   | 9.288                                 |
| Просмотр предметов              | 2.11 KB            | 0.0025                    | 0.005                     | 27                                    |

## Список использованных источников
[^1]: [Steamworks](https://partner.steamgames.com/)
[^2]: [Steam Statistics 2025: Users & Revenue Data](https://www.demandsage.com/steam-statistics/#:~:text=Steam%20has%20132%20million%20monthly%2Ctime%20high%20of%20%2410.8%20billion)
[^3]: [Steam Users by Country 2025](https://worldpopulationreview.com/country-rankings/steam-users-by-country)
[^4]: [Trade.TF - Trade Volume](https://www.trade.tf/volume)
[^5]: [Steam Market Data | Video Game Insights](https://app.sensortower.com/vgi/steam-market-data)
[^6]: [Steam Game Release Summary by Year · SteamDB](https://steamdb.info/stats/releases/)
[^7]: [Steam in 2017](https://media.gdcvault.com/gdc2018/presentations/Steam_in_2017.pdf)
[^8]: [Steam | Market Overview](https://csgoskins.gg/markets/steam)
[^9]: [Где мои деньги, чувак: о чем молчит Steam](https://habr.com/ru/articles/423215/)
[^10]: [Scanning all possible Steam IDs, and what we have found](https://steamdb.info/blog/scanning-all-steam-ids/)
